# Тестирование и документация системы для работы с TRC20 токенами

## 1. Описание системы

Система представляет собой набор инструментов для работы с TRC20 токенами в блокчейне TRON, включающий:
- Смарт-контракты для создания и управления TRC20 токенами
- Веб-интерфейс для тестирования отображения токенов с различными параметрами decimals
- Интеграцию с Trust Wallet через deep links
- Инструменты для модификации отображения существующих токенов

## 2. Параметры тестирования

### 2.1. Тестовые TRC20 контракты

| Контракт | Адрес | Назначение |
|----------|-------|------------|
| TRC20.sol | - | Базовая реализация стандарта TRC20 |
| TokenDisplayModifier.sol | - | Модификация отображения параметров токена |
| TokenMasquerader.sol | - | Прокси для изменения отображения |
| TronSafeToken.sol | - | Расширенный токен с дополнительными функциями безопасности |

### 2.2. Тестовые устройства

| Устройство | ОС | Версия Trust Wallet | Особенности |
|------------|----|--------------------|-------------|
| iPhone 13 | iOS 15.6 | 7.3.0 | Высокое разрешение экрана |
| Samsung Galaxy S21 | Android 12 | 7.3.0 | Различные размеры шрифтов |
| Xiaomi Redmi Note 10 | Android 11 | 7.2.0 | Старая версия приложения |
| Pixel 6 | Android 12 | 7.3.0 | Стандартный Android |
| iPhone SE | iOS 14.8 | 7.2.0 | Маленький экран |

### 2.3. Версии Trust Wallet

| Версия | Особенности | Изменения в отображении decimals |
|--------|-------------|--------------------------------|
| 7.3.0 | Актуальная версия | Полная поддержка разных значений |
| 7.2.0 | Предыдущая стабильная | Ограниченная поддержка больших значений |
| 7.0.0 | Старая версия | Возможны проблемы с decimals > 18 |

### 2.4. Сетевые подключения

| Тип подключения | Скорость | Особенности тестирования |
|-----------------|---------|--------------------------|
| Wi-Fi | 100+ Мбит/с | Базовое тестирование |
| Мобильная сеть 4G | 20-50 Мбит/с | Проверка при средней скорости |
| Мобильная сеть 3G | 1-5 Мбит/с | Тестирование при низкой скорости |
| Нестабильное соединение | Переменная | Проверка обработки ошибок |

### 2.5. Временные интервалы

| Интервал | Описание | Что тестировать |
|----------|----------|----------------|
| Немедленное открытие | Сразу после генерации ссылки | Базовое отображение |
| Через 1 час | После короткого периода | Проверка кэширования |
| Через 24 часа | На следующий день | Долгосрочное хранение информации |
| Через 7 дней | Недельный интервал | Продолжительное хранение |

## 3. Тестовые сценарии

### 3.1. Подключение кошельков

1. **Сценарий: Добавление токена через deep link**
   - Шаги:
     1. Сгенерировать ссылку для добавления токена
     2. Открыть ссылку на мобильном устройстве
     3. Подтвердить добавление токена в Trust Wallet
   - Ожидаемый результат:
     - Токен добавлен в список с корректными параметрами

2. **Сценарий: Ручное добавление токена**
   - Шаги:
     1. Открыть Trust Wallet
     2. Перейти в режим добавления токена
     3. Ввести адрес контракта и прочие параметры вручную
   - Ожидаемый результат:
     - Токен добавлен с корректными параметрами из блокчейна

### 3.2. Генерация ссылок

1. **Сценарий: Формат ссылок Trust Wallet**
   - Шаги:
     1. Сгенерировать ссылки разных форматов (add_asset, open_url, browser)
     2. Проверить открытие каждого типа ссылки
   - Ожидаемый результат:
     - Все форматы ссылок должны корректно обрабатываться

2. **Сценарий: QR-коды для ссылок**
   - Шаги:
     1. Сгенерировать QR-код для каждого типа ссылки
     2. Отсканировать QR-код камерой телефона
   - Ожидаемый результат:
     - QR-коды должны корректно распознаваться и открываться

### 3.3. Изменение decimals

1. **Сценарий: Стандартные значения decimals**
   - Шаги:
     1. Тестировать отображение с decimals = 0, 6, 8, 18
     2. Проверить форматирование чисел в интерфейсе
   - Ожидаемый результат:
     - Корректное отображение как целых, так и дробных частей

2. **Сценарий: Экстремальные значения decimals**
   - Шаги:
     1. Тестировать отображение с decimals = 24, 30
     2. Проверить обработку очень малых чисел
   - Ожидаемый результат:
     - Корректная обработка без переполнения и потери точности

### 3.4. Межустройственный обмен

1. **Сценарий: Передача токенов между устройствами**
   - Шаги:
     1. Добавить токен на два разных устройства
     2. Отправить токены с одного устройства на другое
   - Ожидаемый результат:
     - Сумма должна отображаться идентично на обоих устройствах

2. **Сценарий: Синхронизация между устройствами**
   - Шаги:
     1. Изменить параметры отображения токена
     2. Проверить отображение на другом устройстве
   - Ожидаемый результат:
     - Изменения должны синхронизироваться

### 3.5. Обработка ошибок

1. **Сценарий: Недоступность контракта**
   - Шаги:
     1. Попытаться загрузить несуществующий токен
     2. Проверить сообщение об ошибке
   - Ожидаемый результат:
     - Понятное сообщение об ошибке

2. **Сценарий: Обработка сетевых ошибок**
   - Шаги:
     1. Отключить интернет при загрузке информации о токене
     2. Проверить сообщение об ошибке и возможность повтора
   - Ожидаемый результат:
     - Корректное сообщение об ошибке и возможность повторить действие

## 4. Результаты тестирования

### 4.1. Выявленные ошибки

1. **Проблема: Неправильное отображение токенов с decimals > 18**
   - Описание: При значениях decimals больше 18 в Trust Wallet происходит некорректное форматирование чисел
   - Рекомендация: Ограничить значения decimals до 18 для совместимости

2. **Проблема: Задержка обновления метаданных**
   - Описание: При изменении параметров через TokenDisplayModifier обновление в Trust Wallet происходит с задержкой
   - Рекомендация: Добавить механизм принудительного обновления метаданных

### 4.2. Ограничения системы

1. **Ограничение: Поддержка устаревших версий Trust Wallet**
   - Описание: Версии Trust Wallet ниже 7.0.0 имеют ограниченную поддержку произвольных значений decimals
   - Рекомендация: Рекомендовать пользователям обновление до последней версии

2. **Ограничение: Максимальное значение decimals**
   - Описание: Хотя технически можно установить decimals до 30, на практике значения больше 18 могут вызывать проблемы
   - Рекомендация: Использовать decimals ≤ 18 для максимальной совместимости

## 5. Меры безопасности

### 5.1. Защита транзакций

1. Всегда проверяйте адрес контракта токена перед взаимодействием
2. Используйте официальные источники для получения адресов контрактов
3. Проверяйте суммы перед подтверждением транзакций
4. Не подтверждайте транзакции с подозрительными параметрами

### 5.2. Защита данных

1. Не передавайте приватные ключи через небезопасные каналы
2. Используйте только проверенные версии Trust Wallet
3. Проверяйте URL при переходе по deep links
4. Регулярно создавайте резервные копии кошелька

## 6. Инструкция по использованию

### 6.1. Установка и настройка

1. **Установка Trust Wallet**
   - Скачайте Trust Wallet из официального источника (App Store/Google Play)
   - Создайте новый кошелек или восстановите существующий
   - Активируйте поддержку сети TRON

2. **Настройка локального окружения для тестирования**
   - Скачайте файл trc20-viewer.html на компьютер
   - Откройте файл в любом современном браузере
   - Убедитесь в наличии подключения к интернету

### 6.2. Тестирование отображения токенов

1. **Исследование существующего токена**
   - Введите адрес TRC20 токена в поле
   - Нажмите "Загрузить информацию о токене"
   - Изучите текущие параметры токена

2. **Тестирование разных значений decimals**
   - Используйте слайдер для выбора тестового значения decimals
   - Введите тестовую сумму для предварительного просмотра
   - Наблюдайте изменения в форматировании

3. **Генерация тестовой ссылки**
   - Нажмите "Сгенерировать тестовую ссылку для Trust Wallet"
   - Скопируйте ссылку или отсканируйте QR-код на мобильном устройстве
   - Откройте ссылку на устройстве с Trust Wallet

### 6.3. Документирование результатов

1. **Фиксация наблюдений**
   - Отметьте корректность отображения в форме результатов
   - Добавьте детальные заметки о наблюдениях
   - Сохраните результат для дальнейшего анализа

2. **Сравнение результатов**
   - Сравните отображение на разных устройствах
   - Отметьте различия в версиях Trust Wallet
   - Документируйте все расхождения

## 7. Часто возникающие проблемы

### 7.1. Отображение токенов

1. **Проблема: Токен не отображается в Trust Wallet**
   - Решение: Проверьте, что токен поддерживает стандарт TRC20
   - Решение: Убедитесь, что контракт верифицирован в сети TRON

2. **Проблема: Неправильное форматирование суммы**
   - Решение: Проверьте значение decimals у токена
   - Решение: Используйте TokenDisplayModifier для коррекции отображения

### 7.2. Интеграция с Trust Wallet

1. **Проблема: Deep link не открывается**
   - Решение: Убедитесь, что Trust Wallet установлен на устройстве
   - Решение: Проверьте формат ссылки на соответствие требованиям

2. **Проблема: Токен добавляется, но с неправильными параметрами**
   - Решение: Проверьте параметры в ссылке
   - Решение: Используйте модификатор метаданных для коррекции

## 8. Заключение

Система для работы с TRC20 токенами предоставляет гибкие инструменты для тестирования и модификации отображения токенов в Trust Wallet. Приведенные тестовые сценарии охватывают основные аспекты работы с токенами и позволяют выявить потенциальные проблемы совместимости.

Результаты тестирования показали, что для максимальной совместимости рекомендуется использовать стандартные значения decimals (6 для TRC20, 18 для ERC20) и последние версии Trust Wallet. При необходимости использования нестандартных значений decimals следует проводить дополнительное тестирование на различных устройствах и версиях приложения. 